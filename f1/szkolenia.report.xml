<?xml version="1.0" encoding="Windows-1250"?>
<data>
  <template>szkolenia.report.xlsx</template>
  <options>
    <!-- reportmode: SingleSheet/MultipleSheets/MultipleDocuments -->
    <reportmode>SingleSheet</reportmode>
    <!-- orientation: Vertial/Horizontal -->
    <orientation>vertical</orientation>
    <readonly>true</readonly>
  </options>
  <optionsview>
    <gridlines>false</gridlines>
    <headers>false</headers>
    <pagecontrol>false</pagecontrol>
  </optionsview>
  <sql><![CDATA[
      SELECT bieglyrewident.OsobaID OsobaID,
             osoba.Imie Imie,
             osoba.Nazwisko Nazwisko,
             bieglyrewident.NumerBR NumerBR,
             -- CONCAT(Imie, ' ', Nazwisko, ' (', NumerBR, ')') ImNaNu,
						 CONCAT(bieglyrewident.OsobaID,'-',2018 + CAST((rok.rok-2016)/3 AS INT)*3-3) as Grupa,
             CONCAT(2018 + CAST((rok.rok-2016)/3 AS INT)*3-3,' - ',2018 + CAST((rok.rok-2016)/3 AS INT)*3 - 1) Okres,
             rok.rok,
             SUM(Godzin_ODZ) Godzin_ODZ,
             SUM(Godzin_Samo) Godzin_SAMO,
             TrainingsFullfilled1Year(bieglyrewident.OsobaID, rok.rok) LimitRocznyOK,
             TrainingsFullfilled3YearPeriod(bieglyrewident.OsobaID, 3YearPeriodStartsAt(rok.rok)) LimitZaOkresOK
        FROM bieglyrewident
        JOIN rok ON True
   LEFT JOIN osoba ON osoba.ID = bieglyrewident.OsobaID
   LEFT JOIN szkolenie ON szkolenie.OsobaID = osoba.ID 
         AND Year(szkolenie.data) = rok.rok
       WHERE rok.rok <= YEAR(Now())
    GROUP BY OsobaID, Okres, Rok
       ]]></sql>
  <!--
  <filters>
    <filter field="ImNaNu">
      <caption>Bieg³y rewident</caption>
      <edittype>multichoice</edittype>
    </filter>
    <filrer field="LimitRocznyOK">
      <caption>Limit roczny OK</caption>
      <edittype>checkbox</edittype>
    </filrer>
  </filters>
  -->
  <datagroups>
    <datagroup>
      <fieldname>Grupa</fieldname>
      <sectionid>0</sectionid>
      <sortorder>ascending</sortorder>
    </datagroup>
  </datagroups>
</data>